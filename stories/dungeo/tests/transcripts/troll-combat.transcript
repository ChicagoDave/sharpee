title: Troll Combat - Melee Interceptor
story: dungeo
author: Sharpee Team
description: Test killing the troll via melee interceptor with RETRY for combat randomness
---

# Get equipment from Living Room
> north
[OK: contains "North of House"]

> east
[OK: contains "Behind House"]

> open window
[OK: contains "open"]

> west
[OK: contains "Kitchen"]

> west
[OK: contains "Living Room"]

# Get the lantern, sword, and turn on lantern
> take lantern
[OK: contains "Taken"]

> take sword
[OK: contains "Taken"]

> switch on lantern
[OK: contains "on"]

# Go to Troll Room
> push rug
[OK: contains "trap door"]

> open trapdoor
[OK: contains "open"]

> down
[OK: contains "Cellar"]

# Enter troll room
> east
[OK: contains "Troll Room"]
[OK: contains "troll"]

# ===== Melee interceptor combat test =====
# RETRY handles player death from counter-attacks â€” restores and retries
# DO/UNTIL loops attack until troll death message or player death

[RETRY: max=5]
[DO]
> attack troll with sword
[UNTIL "slumps to the floor dead" OR "removes his head" OR "He dies" OR "You are dead"]
[ENSURES: not entity "troll" alive]
[END RETRY]

# Passage north should be clear after troll dies
> north
[OK: contains "East-West Passage"]

# Go back to troll room and verify troll is gone
> south
[OK: contains "Troll Room"]
[OK: not contains "You can see"]
