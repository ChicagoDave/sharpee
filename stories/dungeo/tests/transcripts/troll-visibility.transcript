title: Troll Axe Visibility via Capability Dispatch
story: dungeo
author: Sharpee Team
description: Tests that the axe is hidden when troll is unconscious (via if.scope.visible capability)

---

# This verifies the generic capability dispatch for visibility works correctly.

# Get to the Troll Room via GDT teleport
> GDT
[OK: contains "GDT"]

> AH Troll Room
[OK: contains "Teleported"]

> look
[OK: contains "Troll Room"]
[OK: contains "bloody axe"]
[OK: contains "troll"]

# Verify axe is mentioned while troll is conscious
> examine axe
[OK: contains "bloody axe"]

# Knock out the troll - should hide the axe
> KO troll
[OK: contains "Knocked out"]
[OK: contains "isConscious: false"]

# Now look again - axe should NOT be visible
> look
[OK: contains "Troll Room"]
[OK: contains "troll"]
[FAIL: contains "bloody axe"]

# Try to take the axe - should fail since it's not visible
> take axe
[OK: contains "can't see"]

# Wake up the troll - axe should reappear
> WU troll
[OK: contains "Woke up"]
[OK: contains "isConscious: true"]

# Axe should be visible again
> look
[OK: contains "bloody axe"]

# But still can't take it (white-hot)
> take axe
[OK: contains "white-hot"]

# Kill the troll - axe becomes takeable
> KL troll
[OK: contains "Killed"]

> take axe
[OK: contains "Taken"]

> inventory
[OK: contains "bloody axe"]

> EX
[OK: contains "Returning to game"]
