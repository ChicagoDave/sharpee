title: Troll Recovery Daemon
story: dungeo
author: Sharpee Team
description: Tests that the troll wakes up after being knocked out, with description change (TROLLDESC -> TROLLOUT), exit blocking/unblocking, and wake up message when player is present.

---

# From MDL source (act1.254): OUT!/IN! transitions
# Recovery time: 5 turns

# Get to the Troll Room via GDT teleport
> GDT
[OK: contains "GDT"]

> AH Troll Room
[OK: contains "Teleported"]

# Verify initial state - exits blocked, conscious troll
> look
[OK: contains "Troll Room"]
[OK: contains "nasty-looking troll"]
[OK: contains "bloody axe"]

# Examine troll - should show TROLLDESC (blocking northern passage)
> examine troll
[OK: contains "blocks"]
[OK: contains "northern passage"]

# Try to go north - blocked by troll
> north
[OK: contains "troll blocks"]

# Knock out the troll via GDT
> KO troll
[OK: contains "Knocked out"]
[OK: contains "isConscious: false"]

# Description should change to TROLLOUT
> examine troll
[OK: contains "unconscious"]
[OK: contains "sprawled"]
[OK: contains "passages"]
[OK: contains "open"]

# North passage should now be open
> north
[OK: contains "East-West Passage"]

# Go back to troll room
> south
[OK: contains "Troll Room"]

# Wait for recovery (5 turns)
> z
[OK]

> z
[OK]

> z
[OK]

> z
[OK]

> z
[OK: contains "troll stirs"]
[OK: contains "fighting stance"]

# Troll should be conscious again
> examine troll
[OK: contains "blocks"]
[OK: contains "northern passage"]

# Exit should be blocked again
> north
[OK: contains "troll blocks"]

# Exit GDT mode
> EX
[OK: contains "Returning to game"]
