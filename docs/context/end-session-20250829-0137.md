# EntryTrait Removal and Action Simplification Summary

## Date: 2025-08-29

## Overview
Completed major refactoring to simplify the entering/exiting action system by removing the unnecessary EntryTrait and creating a dedicated ClimbableTrait for climbing actions.

## Key Changes

### 1. Removed EntryTrait
- **Deleted**: `packages/world-model/src/traits/entry/` directory and all related files
- **Rationale**: EntryTrait was redundant complexity - entering/exiting only needs containers and supporters with `enterable` flags
- **Impact**: Simplified the mental model for spatial relationships in the IF engine

### 2. Simplified Entering Action
- **Location**: `packages/stdlib/src/actions/standard/entering/entering.ts`
- **Changes**:
  - Now only checks `container.enterable` or `supporter.enterable` flags
  - Removed all EntryBehavior dependencies
  - Simplified execute method to just move actor to target
  - Containers use preposition 'in', supporters use 'on'

### 3. Simplified Exiting Action  
- **Location**: `packages/stdlib/src/actions/standard/exiting/exiting.ts`
- **Changes**:
  - Simply moves actor to parent location
  - No longer uses EntryBehavior
  - Determines preposition based on container vs supporter

### 4. Created ClimbableTrait
- **New Files**:
  - `packages/world-model/src/traits/climbable/climbableTrait.ts`
  - `packages/world-model/src/traits/climbable/climbableBehavior.ts`
  - `packages/world-model/src/traits/climbable/index.ts`
- **Purpose**: Dedicated trait for objects that can be climbed (ladders, trees, mountains)
- **Properties**:
  - `canClimb`: Whether climbing is currently possible
  - `direction`: 'up' | 'down' | 'both'
  - `destination`: Optional target location after climbing
  - `blockedMessage`: Custom message when climbing is blocked
  - `successMessage`: Custom success message

### 5. Updated Climbing Action
- **Location**: `packages/stdlib/src/actions/standard/climbing/climbing.ts`
- **Changes**:
  - Now uses ClimbableTrait instead of EntryTrait
  - Falls back to enterable supporters for climbing onto things
  - Cleaner separation between climbing objects vs directional climbing

### 6. Test Updates
- **Modified Tests**:
  - `entering-golden.test.ts`: 4 tests skipped (Entry-specific features removed)
  - `exiting-golden.test.ts`: 7 tests skipped (Entry-specific features removed)  
  - `climbing-golden.test.ts`: Updated to use ClimbableTrait
- **Test Results**: All movement action tests passing (39 passed, 11 skipped)

## Architecture Improvements

### Before
```
Entity can have:
- EntryTrait (for entering/exiting/climbing)
- Container trait with enterable flag
- Supporter trait with enterable flag
```

### After
```
Entity can have:
- Container trait with enterable flag (for entering/exiting)
- Supporter trait with enterable flag (for entering/exiting)
- ClimbableTrait (specifically for climbing)
```

## Benefits
1. **Clearer Semantics**: Each trait has a single, clear purpose
2. **Reduced Complexity**: Removed redundant trait and behavior code
3. **Better Separation**: Climbing is now distinct from entering/exiting
4. **Simpler Mental Model**: Containers and supporters are enterable, special objects are climbable

## Migration Notes
Any code using EntryTrait needs to be updated:
- For entering/exiting: Use Container or Supporter with `enterable: true`
- For climbing: Use the new ClimbableTrait
- Custom prepositions (like 'under', 'behind') are no longer supported in core - can be added via event handlers if needed
- Occupancy tracking is no longer part of core traits - implement via event handlers if needed

## Files Changed
- **Deleted**: 3 files (entry trait/behavior/index)
- **Created**: 4 files (climbable trait/behavior/index + summary)
- **Modified**: 15+ files (actions, tests, exports, type definitions)

## Status
âœ… Complete - All tests passing, code building successfully