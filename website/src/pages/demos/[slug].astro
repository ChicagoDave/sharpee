---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const demos = await getCollection('demos');
  return demos.map((demo) => ({
    params: { slug: demo.slug },
    props: { demo },
  }));
}

const { demo } = Astro.props;
const { Content } = await demo.render();
---

<BaseLayout title={demo.data.title} description={demo.data.description}>
  <article class="py-12">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="mb-8">
          <a href="/demos" class="text-emerald-600 hover:text-emerald-700 text-sm font-medium">
            &larr; Back to Demos
          </a>
          <h1 class="mt-4 text-4xl font-bold text-slate-900">{demo.data.title}</h1>
          <p class="mt-2 text-lg text-slate-600">{demo.data.description}</p>

          <div class="mt-4 flex flex-wrap items-center gap-4 text-sm text-slate-500">
            <span>
              by {demo.data.authors.map((a, i) => (
                <>
                  {a.url ? (
                    <a href={a.url} class="text-emerald-600 hover:text-emerald-700" target="_blank" rel="noopener">{a.name}</a>
                  ) : (
                    <span>{a.name}</span>
                  )}
                  {i < demo.data.authors.length - 1 && ', '}
                </>
              ))}
            </span>
            <span>&bull;</span>
            <span>Version {demo.data.version}</span>
          </div>
        </header>

        <!-- Play buttons -->
        <div class="mb-8 flex flex-wrap gap-3">
          {demo.data.platforms.browser && (
            <a
              href={demo.data.platforms.browser}
              class="inline-flex items-center gap-2 px-6 py-3 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition-colors"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Play in Browser
            </a>
          )}
          {demo.data.platforms.electron && (
            <a
              href={demo.data.platforms.electron}
              class="inline-flex items-center gap-2 px-6 py-3 bg-slate-700 text-white font-semibold rounded-lg hover:bg-slate-600 transition-colors"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
              </svg>
              Download Desktop
            </a>
          )}
          {demo.data.platforms.screenReader && (
            <a
              href={demo.data.platforms.screenReader}
              class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
              Screen Reader Version
            </a>
          )}
        </div>

        <!-- Cover image -->
        {demo.data.coverImage && (
          <div class="mb-8">
            <img
              src={demo.data.coverImage}
              alt={`${demo.data.title} screenshot`}
              class="w-full rounded-lg shadow-lg"
            />
          </div>
        )}

        <!-- Content -->
        <div class="prose prose-slate max-w-none">
          <Content />
        </div>
      </div>
    </div>
  </article>
</BaseLayout>
