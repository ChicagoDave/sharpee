---
interface Platform {
  browser?: string;
  electron?: string;
  screenReader?: string;
}

interface Author {
  name: string;
  url?: string;
}

interface Props {
  title: string;
  description: string;
  coverImage?: string;
  authors: Author[];
  version: string;
  platforms: Platform;
  slug: string;
  type: 'demo' | 'game';
}

const { title, description, coverImage, authors, version, platforms, slug, type } = Astro.props;
const href = `/${type}s/${slug}`;
---

<article class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
  <a href={href} class="block">
    {coverImage ? (
      <img
        src={coverImage}
        alt={`${title} cover`}
        class="w-full h-48 object-cover"
      />
    ) : (
      <div class="w-full h-48 bg-gradient-to-br from-slate-700 to-slate-900 flex items-center justify-center">
        <span class="text-4xl text-slate-500">IF</span>
      </div>
    )}
  </a>

  <div class="p-4">
    <a href={href} class="block">
      <h3 class="text-lg font-semibold text-slate-900 hover:text-emerald-600 transition-colors">
        {title}
      </h3>
    </a>

    <p class="text-sm text-slate-600 mt-1 line-clamp-2">
      {description}
    </p>

    <div class="mt-3 flex items-center justify-between text-xs text-slate-500">
      <span>
        by {authors.map((a, i) => (
          <>
            {a.url ? (
              <a href={a.url} class="hover:text-emerald-600" target="_blank" rel="noopener">{a.name}</a>
            ) : (
              <span>{a.name}</span>
            )}
            {i < authors.length - 1 && ', '}
          </>
        ))}
      </span>
      <span class="text-slate-400">{version}</span>
    </div>

    <div class="mt-3 flex gap-2">
      {platforms.browser && (
        <a
          href={platforms.browser}
          class="inline-flex items-center gap-1 px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-xs font-medium hover:bg-emerald-200 transition-colors"
        >
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
          </svg>
          Play Online
        </a>
      )}
      {platforms.electron && (
        <a
          href={platforms.electron}
          class="inline-flex items-center gap-1 px-2 py-1 bg-slate-100 text-slate-700 rounded text-xs font-medium hover:bg-slate-200 transition-colors"
        >
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
          </svg>
          Desktop
        </a>
      )}
      {platforms.screenReader && (
        <a
          href={platforms.screenReader}
          class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium hover:bg-blue-200 transition-colors"
          title="Screen reader optimized"
        >
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
          Accessible
        </a>
      )}
    </div>
  </div>
</article>
